import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.ArrayList;

import javax.swing.text.html.HTMLEditorKit.Parser;

public class TravelAgency {

	private ArrayList<Cruise> cruises;
	private ArrayList<Ship> ships;

	public TravelAgency() {
		cruises = new ArrayList<>();
		ships = new ArrayList<>();
	}

	public static void main(String[] args) {
		

	}
	
	public void start() throws IOException{
		File file= new File("/Module/data/cruises.dat");
		readShips(file);
		readCruises(file);
	}

	private void readShips(File file) throws IOException{
		AgencyReader reader = new AgencyReader(file);
		for (int index=0; index < reader.getFileSize(); index++){
			String[] tokens = reader.processLine(index);
			
			String codigoBarco= tokens[0];
			String denominacion=tokens[1];
			String descripcion=tokens[2];
			long numeroCamarotes=Long.parseLong(tokens[3]);
			double precioCamarotes=Double.parseDouble(tokens[4]);
			Ship barco=new Ship(codigoBarco, denominacion, descripcion, numeroCamarotes, precioCamarotes);
			ships.add(barco);
		}
	}
	
	private void readCruises(File file) throws IOException {
		AgencyReader parser = new AgencyReader(file);
		for (int index = 0; index < parser.getFileSize(); index++) {
			String[] tokens = parser.processLine(index);
			String codigoCrucero = tokens[0];
			String zona= tokens[1];
			String denominacion= tokens[2];
			String puertoSalida=tokens[3];
			String itinerario= tokens[4];
			String descripcion=tokens[5];
			boolean aptoMenores;
			if (tokens[6]=="S"){
				aptoMenores=true;
			}
			else{
				aptoMenores=false;
			}
			int duration=Integer.parseInt(tokens[7]);
			String[] fechasSalida=tokens[8].split("%");
			String codigoBarco=tokens[9];
			Ship barco=findBarco(codigoBarco);
			Cruise crucero = new Cruise(codigoCrucero, zona, denominacion, puertoSalida, itinerario, descripcion,
					aptoMenores, duration, fechasSalida, barco);
			
			cruises.add(crucero);
		}
	}

	private Ship findBarco(String codigoBarco) {
		for (Ship barco : ships){
			if(barco.getCodigoBarco().equals(codigoBarco)){
				return barco;
			};
		}
		Ship barco=new Ship(codigoBarco);
		ships.add(barco);
		return barco;
	}

}
